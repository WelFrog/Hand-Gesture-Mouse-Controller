# 基于 MediaPipe 的视觉手势桌面交互

本项目是一个桌面鼠标控制系统，通过摄像头实时捕捉手部关键点，结合平滑和加速算法，实现低延迟、精确的隔空鼠标操作。本系统特别优化了性能瓶颈，采用自定义编译的 C++ DLL 进行鼠标底层控制，以确保流畅稳定的用户体验。

## 1. 核心技术特性与优势

### 1.1. 高性能控制架构
* **C++ DLL 驱动:** 鼠标的移动和点击操作通过 `ctypes` 调用由 C++ 编写的 `MouseController.dll` 实现。这绕过了传统 Python 库的性能限制，直接与操作系统底层 API 交互，确保极低的延迟和高响应速度。
* **MediaPipe 高精度识别:** 使用 Google MediaPipe Hands 库，提供 21 个手部关键点的精确追踪，是所有手势判断的基础。

### 1.2. 智能光标移动
* **指数平滑处理:** 引入指数平滑算法优化移动轨迹，消除手部细微抖动，使光标移动稳定可控。
* **动态加速因子:** 通过配置 `acceleration_factor`，实现手部小范围移动即可映射到屏幕大范围像素位移，有效提升操作效率。

### 1.3. 创新的粘滞拖动模式
* **粘滞模式 (Sticky Mode):** 设计用于解决拖动操作的稳定性问题。
* **计时机制:** 持续捏合时间超过 **0.5 秒** 强制进入粘滞（持续按下左键），只有持续松开时间超过 **0.3 秒** 才会释放左键，极大提高了拖动操作的可靠性。

### 1.4. 智能操作手追踪
* **多手兼容性:** 在多手出现时，系统通过计算与“上一帧操作手腕”的最小距离，智能识别并锁定当前操作手，避免光标跳动和干扰。

## 2. 关键算法速览 (Design Principle Quick Look)

本项目依赖以下关键算法和逻辑，实现了高性能和稳定性的平衡：

* **光标平滑:** 鼠标速度更新采用**指数平滑公式** $V_{new} = \alpha \cdot V_{old} + (1 - \alpha) \cdot \Delta_{input}$，其中 $\alpha = 0.8$，确保手部输入的平稳过渡。
* **移动状态锁:** 通过监测**小指/无名指到手腕的归一化欧氏距离**（阈值 $ < 0.2$）来明确锁定和释放移动状态。
* **性能底层:** 使用 `ctypes` 加载 DLL，以 C/C++ **Windows API**（`SendInput`）作为底层驱动，实现高性能的鼠标操作。
* **操作手锁定:** 采用**最小距离原则**来锁定操作手，确保在多手环境下追踪的稳定性。

## 3. 功能操作指南

本系统通过特定的手部姿态来触发鼠标控制功能。

| 功能 | 手势描述 | 关键点判断逻辑 |
| :--- | :--- | :--- |
| **光标移动** | 无名指与小指靠近手腕，进入锁定状态 | 归一化距离均小于 $0.2$ |
| **左键点击/按下** | 拇指与食指捏合 | 拇指尖与食指尖坐标差异均小于 $0.05$ |
| **拖动 (粘滞模式)** | 持续捏合时间 $\ge 0.5$ 秒 | 释放需持续松开时间 $\ge 0.3$ 秒 |

## 4. 环境与安装

### 4.1. 环境要求
* 操作系统: Windows (DLL 依赖)
* Python 版本: 3.x
* 摄像头: 兼容 OpenCV 的网络摄像头

### 4.2. 依赖安装

请确保您已安装所需的 Python 依赖包。

在控制台中运行代码：

``pip install -r requirements.txt``
